CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `SakilaSource1`.`RentalExtractView` AS select `r`.`rental_id` AS `rental_id`,cast(`r`.`rental_date` as date) AS `rental_date`,`r`.`customer_id` AS `customer_id`,`i`.`film_id` AS `film_id`,`p`.`amount` AS `amount`,`i`.`store_id` AS `store_id`,(to_days(`r`.`return_date`) - to_days(`r`.`rental_date`)) AS `duration` from (((`SakilaSource1`.`inventory` `i` join `SakilaSource1`.`rental` `r` on((`i`.`inventory_id` = `r`.`inventory_id`))) join `SakilaSource1`.`customer` `cus` on((`r`.`customer_id` = `cus`.`address_id`))) join `SakilaSource1`.`payment` `p` on((`r`.`rental_id` = `p`.`rental_id`))) where (`r`.`return_date` is not null) group by `r`.`rental_id`,`r`.`rental_date`,`r`.`customer_id`,`i`.`film_id`,`p`.`amount`,`r`.`return_date`,`i`.`store_id`;
